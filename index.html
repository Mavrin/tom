<!DOCTYPE html>
<html lang="en">
<head>
    <title>Сказ о microservices</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="node_modules/shower-material/styles/screen-16x10.css">
    <style>
        .hidePage::after {
            visibility: hidden;
        }
    </style>
    <style>
        .grid-stack {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-gap: 50px;
            grid-auto-rows: minmax(100px, auto);
        }
        .grid-stack div {
            display: flex;
            align-items: center;
        }
        .grid-stack a {
            background: none;
        }
        .grid-stack img {
            height: 6em;
        }
        .grid-stack-one {
            grid-column: 1;
            grid-row: 1;
        }
        .grid-stack-two {
            grid-column: 2;
            grid-row: 1;
        }
        .grid-stack-three {
            grid-column: 3;
            grid-row: 1;
        }
        .grid-stack-four {
            grid-column: 1;
            grid-row: 2;
        }
        .grid-stack-five {
            grid-column: 2;
            grid-row: 2;
        }
        .grid-stack-six {
            grid-column: 3;
            grid-row: 2;
        }

    </style>
</head>
<body class="shower list">

<header class="caption">
    <h1>Сказ о microservices</h1>
    <p><a target="_blank" href="https://twitter.com/krivlenia">Константин Кривленя</a></p>

    <p style="font-size: .4em;margin-top: 20px;">Компания <a target="_blank" href="https://goo.gl/Wrm5CU">Targetprocess</a></p>
</header>
<section class="slide">
    <div>
        <h2>Немного о себе</h2>
        <div style="display: flex">
            <div style="flex-shrink: 1"><img style="padding-right: 20px" src="pictures/64lMqg7R6g4.jpg" alt=""/></div>
            <div  style="flex-shrink: 2">Зовут меня Константин Кривленя. <br/>Разработчик в <a href="https://goo.gl/TDyXj2">Targetprocess</a>.<br/>
                Помогаю опенсорсной JavaScript-библиотеки чартов <a href="https://taucharts.com/">Taucharts</a>. <br/>
                <a
                        style="background:url(pictures/twitter-bird-light-bgs.png) no-repeat;padding-left:40px;"
                        href="https://twitter.com/Krivlenia">Twitter (https://twitter.com/Krivlenia/)</a><br>
                <a style="background:url(pictures/GitHub-Mark-32px.png) no-repeat;background-size: contain;
padding-left:40px;"
                   href="https://github.com/Mavrin">Github (https://github.com/Mavrin/)</a><br>
                <a style="background:url(pictures/habrahabr.png) center left no-repeat;padding-left:20px;"
                   href="https://habrahabr.ru/users/mavrin/">Хабр (https://habrahabr.ru/users/mavrin/)</a><br></div>
        </div>
    </div>
</section>
<section class="slide">
    <h2 style="padding-left: 0" class="shout shrink"><span style="display: flex; flex-direction: column; align-items: center;"><span>Monolithic</span> <span>vs</span> <span>Microservices</span></span></h2>
</section>
<section class="slide">
    <h2 class="shout shrink">Monolithic</h2>
</section>
<section class="slide">
    <img class="cover" src="pictures/dom.jpg" alt="Monolithic house"/>
</section>
<section class="slide">
    <img class="cover" src="pictures/mono-house-redesign.jpg" alt="Monolithic house redesign"/>
</section>
<section class="slide">
    <h2 class="shout shrink">Microservices</h2>
</section>
<section class="slide">
    <img class="cover" src="pictures/microservices_house.jpg" alt="Microservices house"/>
</section>
<section class="slide">
    <img class="cover" src="pictures/rumah-kubik.jpg" alt="real Microservices house"/>
</section>
<section class="slide">
    <h2 class="shout shrink">Что такое микросервисы?</h2>
</section>
<section class="slide">
    <p>
        Микросервисы — современное представление
        <a href="https://ru.wikipedia.org/wiki/%D0%A1%D0%B5%D1%80%D0%B2%D0%B8%D1%81-%D0%BE%D1%80%D0%B8%D0%B5%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D0%B0%D1%8F_%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0">сервис-ориентированной
            архитектуры</a>
        (SOA),
        используемое для создания распределенных программных систем.
        Как и в SOA, модули в архитектуре микросервисов взаимодействуют по сети друг с другом для выполнения цели.
        Ещё одно сходство в том, что микросервисы используют протоколо-независимую технологию.
        Данная архитектура является первой реализацией SOA, появившейся после внедрения DevOps,
        и она постепенно становится стандартом для непрерывно развивающихся систем
    </p>
    <a href="https://ru.wikipedia.org/wiki/%D0%9C%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D1%8B">Wikipedia</a>
</section>
<section class="slide">
    <h2>Философия</h2>
    <p>
    <ul>
        <li class="next">Сервисы — небольшие, выполняют каждый свою, единственную функцию</li>
        <li class="next">Организационная культура включает в себя автоматизацию разработки и тестирования,
            это снижает нагрузку на управление
        </li>
        <li class="next">Принципы культуры и дизайна должны включать в себя «обход» прежних ошибок</li>
        <li class="next">Каждый сервис — эластичный, легко меняющийся, элементарный и при этом законченный.</li>
    </ul>
    </p>
</section>
<section class="slide">
    <h2 class="shout shrink">Unix way</h2>
</section>
<section class="slide">
    <h2>Команда ls</h2>
    <p>
        44 опции в версии <a href="https://ru.wikipedia.org/wiki/GNU">GNU</a>
    </p>
</section>
<section class="slide">
    <h2 class="shout">Demo</h2>
</section>
<section class="slide">
    <h2 class="shout">Разбиение на сервисы</h2>
    <footer>
        How to decompose an application into services?
        <ul>
            <li>Decompose by business capability - define services corresponding to business capabilities</li>
            <li>Decompose by subdomain - define services corresponding to DDD subdomains</li>
        </ul>
    </footer>
</section>
<section class="slide">
    <h2>Сложности программирования</h2>
    <figure>
        <blockquote>
            <p>
                В компьютерных науках есть две сложности: инвалидация кэша, именование и ошибка на единицу.
            </p>
        </blockquote>
        <figcaption>Нородная мудрость</figcaption>
    </figure>
</section>
<section class="slide hidePage">
    <img src="pictures/old_vizydrop_schema.svg" class="cover" alt="old vizydrop schema">
</section>
<section class="slide hidePage">
    <img src="pictures/new_vizydrop_schema.svg" class="cover" alt="new vizydrop schema">
</section>
<section class="slide">
    <blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Architect: &quot;we should break this down into 6 microservices&quot;<br>Me: &quot;you have 6 teams who hate each other?&quot;<br>Architect: &quot;how did you know that?&quot;</p>&mdash; Colette Alexander (@colettecello) <a href="https://twitter.com/colettecello/status/749052871719591937?ref_src=twsrc%5Etfw">July 2, 2016</a></blockquote>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</section>
<section class="slide">
    <h2 class="shout">Процесс разработки</h2>
</section>
<section class="slide">
    <h2>Cтек технологий</h2>

    <div class="grid-stack">
        <div class="grid-stack-five"><a href="https://nodejs.com"><img src="pictures/nodejs.svg" alt="nodejs"></a></div>
        <div class="grid-stack-two"><a href="https://www.python.org/"><img src="pictures/python.svg" alt="python"></a></div>
        <div class="grid-stack-three"><a href="https://www.postgresql.org/"><img src="pictures/Postgresql_elephant.svg" alt="PostgreSQL"></a></div>
        <div class="grid-stack-four"><a href="https://www.mongodb.com/"><img style="height: 3em" src="pictures/mongodb.svg" alt="mongodb"></a></div>
        <div class="grid-stack-one"><a href="https://taucharts.com"><img style="height: 1.5em" src="pictures/logo-color.svg" alt="Taucharts"></a></div>
        <div class="grid-stack-six"><a href="https://facebook.github.io/react/"><img src="pictures/react.svg" alt="React"></a></div>
    </div>
</section>
<section class="slide">
    <img src="pictures/nodejs-vs-python.png" class="cover" alt="nodejs vs python">
</section>
<section class="slide">
    <h2>Выбор языка программирования</h2>
    <p>
        Выбирайте тот инструмент,
        который знает большинство в команде,
        если нет специфики задачи,
        которая определяет выбор.
    </p>
</section>
<section class="slide">
    <h2 class="shout">Процесс разработки</h2>
    <p>
    <ul>
        <li class="next">Отдельный репозиторий для каждого сервиса</li>
        <li class="next">Артифакт запуска на CI docker контейнер</li>
        <li class="next">Тесты запускают внутри контейнера</li>
        <li class="next">Docker compose для запуска интеграционных тестов</li>
        <li class="next">Запуск e2e на каждый билд на любом сервисе (отказались)</li>
    </ul>
    </p>
</section>

<section class="slide">
    <h2>Нельзя вот так просто взять и начать писать микросервисы</h2>
    <p>
    <ul>
        <li class="next">Архитектура микросервисная, а код пишем как монолит.</li>
        <li class="next">Много усилий на создание инфраструктуры</li>
        <li class="next">Проблемы дебага приложений</li>
    </ul>
    </p>
    <footer>
        Разработка одновреммено нескольких сервисов
        Не поддержка совместимостей между версиями.
    </footer>
</section>
<section class="slide">
    <h2 class="shout">Тестирование</h2>
</section>
<section class="slide">
    <h2>Тестирование</h2>
    <p>
    <ul>
        <li class="next">Unit</li>
        <li class="next">Integration (service public api)</li>
        <li class="next">e2e тесты на все сервисы перед релизом</li>
    </ul>
    </p>
</section>
<section class="slide">
    <h2>Как запускать интреграционные тесты</h2>
    <p>
        Пишем серивис, который отдает зависимости для каждого сервиса и указывает на master branch сервисов.
        В нашем случае docker-compose.yml файл.
    </p>
    <footer>
        примеры ответов с сервиса
    </footer>
</section>
<section class="slide">
    <h2>Проблемы c CI</h2>
    <p>
        Конфигурация запуска тестов хранится в отдельном репозитории, а должен в репозитории сервиса.
    </p>
</section>
<section class="slide">
    <h2>Как делать ручное тестирование?</h2>
    <p>
        Пишем сервис, который позволяет QA конфигурировать по версии билда приложение.
    </p>
</section>
<section class="slide">
   <h2 class="shout">Deploy</h2>
</section>
<section class="slide">
    <p>
        <ul>
            <li class="next">Kubernetes</li>
            <li class="next">Helm for package manager</li>
        </ul>
    </p>
</section>
<section class="slide">
    <p>
        Каждый коммит в master раскатывает новую версию на staging сервер (так было)
    </p>
</section>
<section class="slide">
    <h2>Проблема</h2>
    <p>
        Легко ошибится в конфигурации сервиса. Забыть добавить в общий чарт новую версию чарта.
    </p>
</section>
<section class="slide">
    <h2 class="shout">Мониторинг</h2>
</section>
<section class="slide">
    <h2 class="shout">Логи Kibana</h2>
</section>
<section class="slide">
    <h2 class="shout">Метрики Prometheus</h2>
</section>
<section class="slide">
    <h2 class="shout">Grafana для визуализации данных</h2>
</section>
<section class="slide">
    <h2>https://sensuapp.org/ для alerting в слак</h2>
</section>
<section class="slide">
    <h2>Как это дебажить?</h2>
</section>
<section class="slide">
    <h2>Логи наше все, но их нужно связать</h2>
</section>
<section class="slide">
    <h2>zipkin or https://www.envoyproxy.io</h2>
</section>
<section class="slide">
    <h2>Monolithic  vs Microservices</h2>
    <figure>
        <blockquote>
            <p>
                If you can’t build a well-structured monolith, what makes you think microservices is the answer?
            </p>
        </blockquote>
        <figcaption>Simon Brown</figcaption>
    </figure>
</section>
<div class="progress"></div>

<script src="node_modules/shower-core/shower.min.js"></script>
<!-- Copyright © 2018 Константин Кривленя -->

</body>
</html>